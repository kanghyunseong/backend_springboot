<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kh.pcar.back.boards.notice.model.dao.NoticeMapper">

    <!-- 조회수 증가 -->
    <update id="increaseCount">
        UPDATE TB_NOTICE
        SET NOTICE_COUNT = NOTICE_COUNT + 1
        WHERE NOTICE_NO = #{noticeNo}
          AND NOTICE_STATUS = 'Y'
    </update>

    <!-- 전체 조회 -->
    <select id="findAll"
            resultType="com.kh.pcar.back.boards.notice.model.dto.NoticeDTO">
        SELECT
            N.NOTICE_NO      AS noticeNo,
            N.NOTICE_TITLE   AS noticeTitle,
            M.USER_ID        AS noticeWriter,
            N.NOTICE_CONTENT AS noticeContent,
            N.NOTICE_DATE    AS noticeDate,
            N.NOTICE_COUNT   AS noticeCount
        FROM TB_NOTICE N
        JOIN TB_MEMBER M
          ON N.NOTICE_WRITER = M.USER_NO
        WHERE N.NOTICE_STATUS = 'Y'
        ORDER BY N.NOTICE_NO DESC
    </select>

    <!-- 상세 조회 -->
    <select id="findById"
            resultType="com.kh.pcar.back.boards.notice.model.dto.NoticeDTO">
        SELECT
            N.NOTICE_NO      AS noticeNo,
            N.NOTICE_TITLE   AS noticeTitle,
            M.USER_ID        AS noticeWriter,
            N.NOTICE_CONTENT AS noticeContent,
            N.NOTICE_DATE    AS noticeDate,
            N.NOTICE_COUNT   AS noticeCount
        FROM TB_NOTICE N
        JOIN TB_MEMBER M
          ON N.NOTICE_WRITER = M.USER_NO
        WHERE N.NOTICE_NO = #{noticeNo}
          AND N.NOTICE_STATUS = 'Y'
    </select>

</mapper>